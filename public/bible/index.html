<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Bible Embedding Example</title>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons|Material+Icons+Outlined">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

  <script type="module">
    import { loadModule } from 'https://klesun.github.io/ts-browser/src/ts-browser.js';
    window.addEventListener("load", async () => {
      // I don't know no javascript - so I use typescript...
      const mod = await loadModule('./bibledemo.ts');
      window.appInstance = new mod.BibleDemoApp();
    });
  </script>
</head>

<body class="d-flex h-100 text-center text-black">
  <div class="cover-container container-xl d-flex flex-column h-100 w-100 p-3 mx-auto">

    <header class="mb-2">
      <div>
        <h3 class="float-md-start mb-0">Bible Lookup</h3>
        <ul class="nav nav-tabs nav-masthead justify-content-center float-md-end" role="tablist">
        <li class="nav-item" role="presentation">
          <a class="nav-link active" id="augmented_response_button" data-bs-toggle="tab" href="#augmented_response_view"
            role="tab" aria-controls="augmented_response_view" aria-selected="true">
            Chat
          </a>
        </li>
        <li class="nav-item" role="presentation">
          <a class="nav-link" id="augmented_template_button" data-bs-toggle="tab" href="#augmented_template_view"
            role="tab" aria-controls="augmented_template_view" aria-selected="false">
            Option
          </a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button"
            aria-expanded="false">Sources</a>
          <ul class="dropdown-menu">
            <li><a class="nav-link" id="verses_view_button" data-bs-toggle="tab" href="#verses_view" role="tab"
                aria-controls="verses_view" aria-selected="false">
                by Verses
              </a></li>
            <li><a class="nav-link" id="chapters_view_button" data-bs-toggle="tab" href="#chapters_view" role="tab"
                aria-controls="chapters_view" aria-selected="false">
                by Chapters
              </a></li>
          </ul>
        </li>
      </ul>
      </div>
    </header>

  

    <div class="tab-content px-3">


      <div class="tab-pane fade show active py-4" id="augmented_response_view" role="tabpanel"
        aria-labelledby="augmented_response_button">
        <div class="row align-items-md-stretch text-start">
          <div class="col-md-6 p-2">
            <div class="h-100 p-4 bg-light rounded-3 text-dark border border-secondary">
              <div class="small mb-4 text-muted">Actual Prompt, Template + Embedded Data</div>
              <div class="my-1" style="min-height:200px">
                <div class="full_augmented_prompt px-2"></div>
              </div>
            </div>
          </div>
          <div class="col-md-6 p-2">
            <div class="h-100 p-4 bg-dark border rounded-3 text-white">
              <div class="small mb-4 text-muted">Retrieval Augmented Response</div>
              <div class="my-1" style="min-height:200px">
                <div class="full_augmented_response"></div>
              </div>
            </div>
          </div>
        </div>

        <div class="input-group input-group-lg pt-4">
          <textarea class="analyze_prompt_textarea form-control" style="height:4em;" placeholder="Enter your prompt"
            type="text"></textarea>
          <button class="analyze_prompt_button btn btn-primary" type="submit">Analyze</button>
        </div>
      </div>


      <div class="tab-pane fade text-start py-4" id="augmented_template_view" role="tabpanel"
        aria-labelledby="augmented_template_button">
        <div class="row align-items-md-stretch">
          <div class="col-md-6 p-2">
            <div class="h-100 p-4 bg-light rounded-3 border border-secondary">
              <div class="small mb-4 text-muted">Embedding Type</div>
              <select class="form-select embedding_type_select">
                <option>Query Verses to Embed Chapters</option>
                <option>Query Verses to Embed Verses</option>
                <option>Query Chapter to Embed Chapter</option>
              </select>
              <img class="embedding_diagram_img img-fluid pt-2" src="" alt="" width="100%" height="100%">
            </div>
          </div>
          <div class="col-md-6 p-2">
            <div class="h-100 p-4 bg-light rounded-3 border border-secondary">
              <div class="small mb-4 text-muted">Prompt Templates</div>
              <select class="form-select prompt_template_select_preset">
                <option selected>Augmented Response</option>
                <option>Write a new chapter</option>
                <option>Provide guidance</option>
                <option>Judge if embeds politically correct</option>
              </select>
              <br>
              <label>Prompt Template: </label><br>
              <textarea style="height:15em;width:100%;" class="prompt_template_text_area"></textarea>
              <br>
              <br>
              <label>Embed Template: </label><br>
              <textarea style="height:5em;width:100%;" class="document_template_text_area"></textarea>
              <button class="reset_template_options_button btn btn-secondary">Default Settings</button>
              <br>
              <br>
            </div>
          </div>
        </div>
      </div>


      <div class="tab-pane fade" id="verses_view" role="tabpanel" aria-labelledby="verses_view_button">
        <figure class="figure">
          <img src="img/retrievalVerses.png" alt="Verses" width="100%" height="100%" class="p-3"
            style="max-width: 60vh;">
          <figcaption class="figure-caption">Retrieval by Verses</figcaption>
        </figure><br>
        <div class="text-start small p-1">Results:</div>
        <div class="lookup_verse_response_feed"></div>
      </div>
      <div class="tab-pane fade" id="chapters_view" role="tabpanel" aria-labelledby="chapters_view_button">
        <figure class="figure">
          <img src="img/retrievalChapters.png" alt="Chapters" width="100%" height="100%" class="p-3"
            style="max-width: 60vh;">
          <figcaption class="figure-caption">Retrieval by Chapters</figcaption>
        </figure><br>
        <div class="text-start small p-1">Results:</div>
        <div class="lookup_chapter_response_feed"></div>
      </div>
    </div>


    <footer class="mt-auto text-muted">
      <p>A Bible RAG Demo by <a href="https://unacog.com" class="text-black">Unacog</a>.</p>
    </footer>
  </div>


  <style>
    html {
      height: 100%;
    }

    .verse_card {
      margin: 12px;
      border-radius: 12px;
      border: solid 1px black;
      padding: 12px;
    }

    .message_text,
    .augmented_message_text {
      width: 100%;
      height: 5em;
      margin-bottom: 12px;
    }

    .verse_card .selected {
      font-weight: bold;
    }

    .full_augmented_prompt,
    .full_augmented_response {
      white-space: pre-wrap;
    }

    label {
      font-weight: bold;
    }
  </style>
</body>

</html>